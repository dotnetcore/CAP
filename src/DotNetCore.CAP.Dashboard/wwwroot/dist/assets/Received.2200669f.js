import{n as l,a as r,b as o,c as n}from"./index.631dd52b.js";import{j as c}from"./index.1f703d65.js";const d={currentPage:1,perPage:10,name:"",group:"",content:""},m={components:{BIconArrowRepeat:r,BIconSearch:o},props:{status:{}},data(){return{subMens:[{variant:"secondary",text:"Succeeded",num:"receivedSucceeded",name:"/received/succeeded"},{variant:"danger",text:"Failed",name:"/received/failed",num:"receivedFailed"}],pageOptions:[10,20,50,100,500],selectedItems:[],isBusy:!1,tableValues:[],isSelectedAll:!1,formData:{...d},totals:0,items:[],infoModal:{id:"info-modal",title:"",content:"{}"}}},computed:{onMetric(){return this.$store.getters.getMetric},fields(){return[{key:"checkbox",label:""},{key:"id",label:this.$t("IdName")},{key:"group",label:this.$t("Group")},{key:"retries",label:this.$t("Retries")},{key:"added",label:this.$t("Added"),formatter:a=>{if(a!=null)return new Date(a).format("yyyy-MM-dd hh:mm:ss")}},{key:"expiresAt",label:this.$t("Expires"),formatter:a=>{if(a!=null)return new Date(a).format("yyyy-MM-dd hh:mm:ss")}}]}},mounted(){this.fetchData()},watch:{status:function(){this.fetchData()},"formData.currentPage":function(){this.fetchData()}},methods:{fetchData(){this.isBusy=!0,n.get(`/received/${this.status}`,{params:this.formData}).then(a=>{this.items=a.data.items,this.totals=a.data.totals}).finally(()=>{this.isBusy=!1})},selectAll(a){a?(this.selectedItems=[...this.items.map(t=>({...t,selected:!0}))],this.items=[...this.selectedItems]):(this.selectedItems=[],this.items=this.items.map(t=>({...t,selected:!1})))},select(a){const{id:t}=a;this.selectedItems.some(e=>e.id==t)?this.selectedItems=this.selectedItems.filter(e=>e.id!=t):this.selectedItems.push(a),this.isSelectedAll=this.selectedItems.length==this.items.length},clearSelected(){this.allSelected=!1,this.selectedItems=[]},info(a,t){this.infoModal.title=a.id.toString(),this.infoModal.content=c.exports({storeAsString:!0}).parse(a.content.trim()),this.$root.$emit("bv::show::modal",this.infoModal.id,t)},pageSizeChange:function(a){this.formData.perPage=a,this.fetchData()},onSearch:function(){this.fetchData()},reexecute:function(){const a=this;n.post("/received/reexecute",this.selectedItems.map(t=>t.id)).then(()=>{this.selectedItems.map(t=>{a.$bvToast.toast(this.$t("ReexecuteSuccess")+"   "+t.id,{title:"Tips",variant:"secondary",autoHideDelay:1e3,appendToast:!0,solid:!0})}),a.clear()})},clear(){this.items=this.items.map(a=>({...a,selected:!1})),this.selectedItems=[],this.isSelectedAll=!1}}};var u=function(){var t=this,e=t._self._c;return e("div",[e("b-row",[e("b-col",{staticClass:"mt-4",attrs:{md:"3"}},[e("b-list-group",t._l(t.subMens,function(s){return e("router-link",{key:s.text,staticClass:"list-group-item text-left list-group-item-secondary list-group-item-action",attrs:{"active-class":"active",to:s.name}},[t._v(" "+t._s(t.$t(s.text))+" "),e("b-badge",{staticClass:"float-right",attrs:{variant:s.variant,pill:""}},[t._v(" "+t._s(t.onMetric[s.num])+" ")])],1)}),1)],1),e("b-col",{attrs:{md:"9"}},[e("h2",{staticClass:"page-line mb-2"},[t._v(t._s(t.$t("Received Message")))]),e("b-form",{staticClass:"d-flex"},[e("div",{staticClass:"col-sm-10"},[e("div",{staticClass:"row mb-2"},[e("label",{staticClass:"sr-only",attrs:{for:"inline-form-input-name"}},[t._v(t._s(t.$t("Name")))]),e("b-form-input",{staticClass:"form-control col mr-4",attrs:{id:"inline-form-input-name",placeholder:t.$t("Name")},model:{value:t.formData.name,callback:function(s){t.$set(t.formData,"name",s)},expression:"formData.name"}}),e("label",{staticClass:"sr-only",attrs:{for:"inline-form-input-name"}},[t._v(t._s(t.$t("Group")))]),e("b-form-input",{staticClass:"form-control col",attrs:{id:"inline-form-input-group",placeholder:t.$t("Group")},model:{value:t.formData.group,callback:function(s){t.$set(t.formData,"group",s)},expression:"formData.group"}})],1),e("div",{staticClass:"row"},[e("label",{staticClass:"sr-only",attrs:{for:"inline-form-input-content"}},[t._v(t._s(t.$t("Content")))]),e("b-form-input",{staticClass:"form-control",attrs:{id:"inline-form-input-content",placeholder:t.$t("Content")},model:{value:t.formData.content,callback:function(s){t.$set(t.formData,"content",s)},expression:"formData.content"}})],1)]),e("b-button",{staticClass:"ml-2 align-self-end",attrs:{variant:"dark"},on:{click:t.onSearch}},[e("b-icon-search"),t._v(" "+t._s(t.$t("Search"))+" ")],1)],1)],1)],1),e("b-row",[e("b-col",{attrs:{md:"12"}},[e("b-btn-toolbar",{staticClass:"mt-4"},[e("b-button",{attrs:{size:"sm",variant:"dark",disabled:!t.selectedItems.length},on:{click:t.reexecute}},[e("b-icon-arrow-repeat",{attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.$t("Re-execute"))+" ")],1),e("div",{staticClass:"pagination"},[e("span",{staticStyle:{"font-size":"14px"}},[t._v(" "+t._s(t.$t("Page Size"))+":")]),e("b-button-group",{staticClass:"ml-2"},t._l(t.pageOptions,function(s){return e("b-button",{key:s,class:{active:t.formData.perPage==s},attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(i){return t.pageSizeChange(s)}}},[t._v(t._s(s)+" ")])}),1)],1)],1),e("b-table",{staticClass:"mt-3",attrs:{id:"datatable",busy:t.isBusy,striped:"","thead-tr-class":"text-left","head-variant":"light","tbody-tr-class":"text-left",small:"",fields:t.fields,items:t.items,"select-mode":"range"},scopedSlots:t._u([{key:"table-busy",fn:function(){return[e("div",{staticClass:"text-center text-secondary my-2"},[e("b-spinner",{staticClass:"align-middle"}),e("strong",{staticClass:"ml-2"},[t._v(t._s(t.$t("Loading"))+"...")])],1)]},proxy:!0},{key:"head(checkbox)",fn:function(){return[e("b-form-checkbox",{on:{change:t.selectAll},model:{value:t.isSelectedAll,callback:function(s){t.isSelectedAll=s},expression:"isSelectedAll"}})]},proxy:!0},{key:"cell(checkbox)",fn:function(s){return[e("b-form-checkbox",{on:{change:function(i){return t.select(s.item)}},model:{value:s.item.selected,callback:function(i){t.$set(s.item,"selected",i)},expression:"data.item.selected"}})]}},{key:"cell(id)",fn:function(s){return[e("b-link",{on:{click:function(i){return t.info(s.item,i.target)}}},[t._v(" "+t._s(s.item.id)+" ")]),e("br"),t._v(" "+t._s(s.item.name)+" ")]}},{key:"cell(group)",fn:function(s){return[e("span",{staticClass:"text-break"},[t._v(" "+t._s(s.item.group))])]}}])}),e("span",{staticClass:"float-left"},[t._v(" "+t._s(t.$t("Total"))+": "+t._s(t.totals)+" ")]),e("b-pagination",{staticClass:"capPagination",attrs:{"first-text":t.$t("First"),"prev-text":t.$t("Prev"),"next-text":t.$t("Next"),"last-text":t.$t("Last"),"total-rows":t.totals,"per-page":t.formData.perPage,"aria-controls":"datatable"},model:{value:t.formData.currentPage,callback:function(s){t.$set(t.formData,"currentPage",s)},expression:"formData.currentPage"}})],1)],1),e("b-modal",{attrs:{size:"lg",id:t.infoModal.id,title:"Id: "+t.infoModal.title,"ok-only":"","ok-variant":"secondary"}},[e("vue-json-pretty",{key:t.infoModal.id,attrs:{showSelectController:"",data:t.infoModal.content}})],1)],1)},f=[],h=l(m,u,f,!1,null,"9de58533",null,null);const v=h.exports;export{v as default};
